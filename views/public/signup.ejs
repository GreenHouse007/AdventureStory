<!DOCTYPE html>
<html lang="en">
  <head>
    <%- include('../partials/head') %>
    <meta name="robots" content="noindex" />
  </head>
  <body>
    <%- include('../partials/header', { user }) %>

    <main class="container auth">
      <section class="form-card">
        <h1 class="title">Create your account</h1>
        <p class="muted">
          Start your journey and track your choices, endings, and awards.
        </p>

        <% if (typeof error !== 'undefined' && error) { %>
        <div class="alert error" data-auth-message="error"><%= error %></div>
        <% } else { %>
        <div class="alert error" data-auth-message="error" hidden></div>
        <% } %>
        <div class="alert success" data-auth-message="success" hidden></div>

        <form
          action="/signup"
          method="post"
          class="stack"
          novalidate
          data-auth-form="signup"
        >
          <% if (locals.csrfToken) { %>
          <input type="hidden" name="_csrf" value="<%= csrfToken %>" />
          <% } %>

          <label class="field">
            <span>Username</span>
            <input
              type="text"
              name="username"
              required
              minlength="3"
              maxlength="32"
              placeholder="shadow_walker"
              value="<%= typeof old !== 'undefined' ? old.username : '' %>"
            />
          </label>

          <label class="field">
            <span>Email</span>
            <input
              type="email"
              name="email"
              inputmode="email"
              autocomplete="email"
              required
              placeholder="you@example.com"
              value="<%= typeof old !== 'undefined' ? old.email : '' %>"
            />
          </label>

          <label class="field">
            <span>Password</span>
            <input
              type="password"
              name="password"
              autocomplete="new-password"
              required
              minlength="8"
              placeholder="••••••••"
            />
          </label>

          <!-- Optional confirm field (uncomment if you add server-side validation)
        <label class="field">
          <span>Confirm Password</span>
          <input type="password" name="passwordConfirm" autocomplete="new-password" required placeholder="••••••••">
        </label>
        -->

          <button class="cta-button" type="submit">Create Account</button>
        </form>

        <div class="auth-links">
          <span>Already have an account?</span>
          <a class="link" href="/login">Log in</a>
        </div>
      </section>
    </main>

    <%- include('../partials/footer') %>
    <script>
      window.firebaseAuthPage = {
        config: <%- JSON.stringify(firebaseConfig || {}) %>,
        mode: "signup",
      };
    </script>
    <script type="module" src="/js/firebase-auth.js"></script>
  </body>
</html>
