<!DOCTYPE html>
<html lang="en">
  <head>
    <%- include('../partials/head') %>
    <meta name="robots" content="noindex" />
  </head>
  <body>
    <%- include('../partials/header', { user }) %>

    <main class="container auth">
      <section class="form-card">
        <h1 class="title">Create your account</h1>
        <p class="muted">
          Start your journey and track your choices, endings, and awards.
        </p>

        <% if (typeof error !== 'undefined' && error) { %>
        <div class="alert error" data-auth-message="error"><%= error %></div>
        <% } else { %>
        <div class="alert error" data-auth-message="error" hidden></div>
        <% } %>
        <div class="alert success" data-auth-message="success" hidden></div>

        <form
          action="/signup"
          method="post"
          class="stack"
          novalidate
          data-auth-form="signup"
        >
          <% if (locals.csrfToken) { %>
          <input type="hidden" name="_csrf" value="<%= csrfToken %>" />
          <% } %>

          <label class="field">
            <span>Username</span>
            <input
              type="text"
              name="username"
              required
              minlength="3"
              maxlength="32"
              placeholder="shadow_walker"
              value="<%= typeof old !== 'undefined' ? old.username : '' %>"
            />
          </label>

          <label class="field">
            <span>Email</span>
            <input
              type="email"
              name="email"
              inputmode="email"
              autocomplete="email"
              required
              placeholder="you@example.com"
              value="<%= typeof old !== 'undefined' ? old.email : '' %>"
            />
          </label>

          <label class="field">
            <span>Password</span>
            <input
              type="password"
              name="password"
              autocomplete="new-password"
              required
              minlength="8"
              placeholder="••••••••"
            />
          </label>

          <!-- Optional confirm field (uncomment if you add server-side validation)
        <label class="field">
          <span>Confirm Password</span>
          <input type="password" name="passwordConfirm" autocomplete="new-password" required placeholder="••••••••">
        </label>
        -->

          <button class="cta-button" type="submit">Create Account</button>
        </form>

        <div class="divider" aria-hidden="true"><span>or</span></div>
        <button class="google-button" type="button" data-google-sign-in>
          <span class="google-button__icon" aria-hidden="true">
            <svg viewBox="0 0 24 24" xmlns="http://www.w3.org/2000/svg" focusable="false">
              <path fill="#EA4335" d="M12 10.2v3.9h5.46c-.24 1.26-.98 2.33-2.1 3.06l3.39 2.64C20.34 17.76 21.5 15.11 21.5 12c0-.75-.07-1.47-.21-2.16H12Z" />
              <path fill="#34A853" d="M6.54 14.3a4.8 4.8 0 0 1 0-4.59L3.15 7.07A8.003 8.003 0 0 0 4 16.95l2.54-2.65Z" />
              <path fill="#4285F4" d="M12 5.5c1.13 0 2.15.39 2.96 1.15l2.21-2.21A7.968 7.968 0 0 0 4 7.05l2.54 2.65A4.77 4.77 0 0 1 12 5.5Z" />
              <path fill="#FBBC05" d="M12 20.5a4.76 4.76 0 0 1-5.46-3.35L4 16.95A7.97 7.97 0 0 0 12 21.5c1.93 0 3.69-.69 5.05-1.86l-3.39-2.64A4.77 4.77 0 0 1 12 20.5Z" />
            </svg>
          </span>
          <span class="google-button__label">Sign up with Google</span>
        </button>

        <div class="auth-links">
          <span>Already have an account?</span>
          <a class="link" href="/login">Log in</a>
        </div>
      </section>
    </main>

    <%- include('../partials/footer') %>
    <script>
      window.firebaseAuthPage = {
        config: <%- JSON.stringify(firebaseConfig || {}) %>,
        mode: "signup",
      };
    </script>
    <script type="module" src="/js/firebase-auth.js"></script>
  </body>
</html>
